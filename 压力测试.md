## 下载工具 httpd-tools
```shell
yum -y install httpd-tools
```

## 压力测试
```
一个线程
Server Software:        H/1.0.0
Server Hostname:        192.168.1.10
Server Port:            7080

Document Path:          /
Document Length:        140 bytes

Concurrency Level:      200
Time taken for tests:   257.320 seconds
Complete requests:      1000000
Failed requests:        0
Non-2xx responses:      1000000
Total transferred:      261000000 bytes
HTML transferred:       140000000 bytes
Requests per second:    3886.22 [#/sec] (mean)
Time per request:       51.464 [ms] (mean)
Time per request:       0.257 [ms] (mean, across all concurrent requests)
Transfer rate:          990.53 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0   22   2.3     22      39
Processing:    11   29   4.3     29      66
Waiting:        1   22   5.0     19      57
Total:         26   51   2.8     52      86

Percentage of the requests served within a certain time (ms)
  50%     52
  66%     53
  75%     53
  80%     53
  90%     55
  95%     56
  98%     57
  99%     59
 100%     86 (longest request)

```

```
三线程
Server Software:        H/1.0.0
Server Hostname:        192.168.1.10
Server Port:            7080

Document Path:          /
Document Length:        140 bytes

Concurrency Level:      200
Time taken for tests:   266.783 seconds
Complete requests:      1000000
Failed requests:        0
Non-2xx responses:      1000000
Total transferred:      261000000 bytes
HTML transferred:       140000000 bytes
Requests per second:    3748.37 [#/sec] (mean)
Time per request:       53.357 [ms] (mean)
Time per request:       0.267 [ms] (mean, across all concurrent requests)
Transfer rate:          955.39 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0   26   3.8     26      48
Processing:     5   28   4.4     27      86
Waiting:        0   20   4.0     20      83
Total:         20   53   2.3     53     106

Percentage of the requests served within a certain time (ms)
  50%     53
  66%     53
  75%     53
  80%     54
  90%     56
  95%     58
  98%     61
  99%     63
 100%    106 (longest request)
```
```
nginx

Server Software:        nginx/1.15.11
Server Hostname:        192.168.1.16
Server Port:            81

Document Path:          /
Document Length:        2307 bytes

Concurrency Level:      200
Time taken for tests:   276.983 seconds
Complete requests:      1000000
Failed requests:        0
Total transferred:      2542000000 bytes
HTML transferred:       2307000000 bytes
Requests per second:    3610.33 [#/sec] (mean)
Time per request:       55.397 [ms] (mean)
Time per request:       0.277 [ms] (mean, across all concurrent requests)
Transfer rate:          8962.35 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0    1   0.5      1      15
Processing:     8   55   9.7     52     195
Waiting:        1   55   9.7     51     195
Total:         16   55   9.6     52     196

Percentage of the requests served within a certain time (ms)
  50%     52
  66%     55
  75%     57
  80%     59
  90%     66
  95%     74
  98%     85
  99%     98
 100%    196 (longest request)
 
 10w个

ab  -n 100000 -c 200  "http://192.168.1.10:7080/" 
 
Server Software:        H/1.0.0
Server Hostname:        192.168.1.10
Server Port:            7080

Document Path:          /
Document Length:        140 bytes

Concurrency Level:      200
Time taken for tests:   25.288 seconds
Complete requests:      100000
Failed requests:        0
Non-2xx responses:      100000
Total transferred:      26100000 bytes
HTML transferred:       14000000 bytes
Requests per second:    3954.41 [#/sec] (mean)
Time per request:       50.576 [ms] (mean)
Time per request:       0.253 [ms] (mean, across all concurrent requests)
Transfer rate:          1007.91 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0   16   4.1     16      27
Processing:    12   34   5.1     34      55
Waiting:        1   25   3.2     25      46
Total:         26   50   5.3     50      74

Percentage of the requests served within a certain time (ms)
  50%     50
  66%     51
  75%     51
  80%     51
  90%     55
  95%     61
  98%     68
  99%     71
 100%     74 (longest request)

 
```

### 可能会有机器的影响

## 长连接测试
```
10w个

ab  -n 100000 -c 200 -k "http://192.168.1.10:7080/"

Server Software:        H/1.0.0
Server Hostname:        192.168.1.10
Server Port:            7080

Document Path:          /
Document Length:        140 bytes

Concurrency Level:      200
Time taken for tests:   14.933 seconds
Complete requests:      100000
Failed requests:        0
Non-2xx responses:      100000
Keep-Alive requests:    100000
Total transferred:      26500000 bytes
HTML transferred:       14000000 bytes
Requests per second:    6696.50 [#/sec] (mean)
Time per request:       29.866 [ms] (mean)
Time per request:       0.149 [ms] (mean, across all concurrent requests)
Transfer rate:          1732.98 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0    0   0.9      0      26
Processing:     0   30   4.2     30      34
Waiting:        0   30   4.2     30      34
Total:          0   30   4.2     30      37

Percentage of the requests served within a certain time (ms)
  50%     30
  66%     30
  75%     31
  80%     31
  90%     31
  95%     31
  98%     32
  99%     32
 100%     37 (longest request)
```

## 查看
```
// 查看端口
[hh@hh ~]$ netstat -ltnp | grep :7080
(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
tcp        0      0 0.0.0.0:7080            0.0.0.0:*               LISTEN      2004976/my_http_ser

// 通过进程查看所有链接
[hh@hh ~]$ netstat -ntlap | grep 2004976

// 查看链接数量
[hh@hh ~]$ netstat -ntlap | grep 2004976 | wc -l

```

